pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
-- jeu diversidays & inclusivedays
-- by picolas

function _init()
 create_player()
end

function _update()
  player_movement()
  update_camera() 
  
end

function _draw()
		cls(14)
		draw_map()
		draw_player()
		draw_ui()
end


-->8
-- map

function draw_map()
    map (0,0,0,0,128,64)
end

function check_flag(flag,x,y)
    local sprite=mget(x,y)
    return fget(sprite,flag)
end

function update_camera()
		camx=flr(p.x/16)*16
		camy=flr(p.y/16)*16
		camera(camx*8,camy*8)
end

function old_camera()
		camx=mid(0,p.x-7.5,31-15)
		camy=mid(0,p.y-7.5,31-15)
		camera(camx*5,camy*9)
end

function next_tile(x,y)
	sprite=mget(x,y)
	mset(x,y,sprite+1)
end

function pick_up_kdo(x,y)
	next_tile(x,y)
	--p.dei=p.dei+1
	sfx(0)
end

function open_door()
	next_tile(x,y)
	sfx(1)
end
-->8
-- player

function create_player()
    p={
    x=6,
    y=7,
    sprite=1,
    dei=0
    }
end

function player_movement()
    newx=p.x
    newy=p.y
    if (btnp(➡️)) newx+=1
    if (btnp(⬅️)) newx-=1
    if (btnp(⬇️)) newy+=1
    if (btnp(⬆️)) newy-=1
    p={x=newx,y=newy,sprite=1}
  
    interact (newx,newy)
   
    if not check_flag(0,newx,newy) then
   	p.x=mid(0,newx,127)
    p.y=mid(0,newy,63)
    end
end

function interact(x,y)
 if check_flag(1,x,y) then
		pick_up_kdo(x,y)
		elseif check_flag(2,x,y)
		--and p.dei>0 then
			then 	open_door(x,y)
			
	end
end

function draw_player()
		spr(p.sprite,p.x*8,p.y*8) 
end
-->8
function draw_ui()
	camera()
	spr(10,2,2)
	print("X"..0,10,2,7)
end
__gfx__
00000000077877000000000066666666030630b0000000006666666666666666000000000040000000000a000000000000000000000000000000000000000000
000000000788870000bbbbbb66666666303ffb030000000066666666666666660000000004400000000000000000000000000000000000000000000000000000
000000000778770000b4444b666666660b0390300aaaaa0066a88a666666666600000000440000000aa00a000000000000000000000000000000000000000000
000000000fffff0000b4004b66666666b033330baa000a00668888666666666640404040404000000a0a0a000000000000000000000000000000000000000000
000000009f3f3f9000b4044b666666660b0330b0aa000a0066a88a666666666644444440044000000a0a0a000000000000000000000000000000000000000000
000000000efffe0000b4004b6666666600b3bb000aaaaa00644444466444444640404040444000000aa00a000000000000000000000000000000000000000000
0000000000e8e00000b4444b666666660003300000aa000066000066660000664444444044000000000000000000000000000000000000000000000000000000
000000007777777000bbbbbb66666666000550000000000066666666666666664040404040000000000000000000000000000000000000000000000000000000
__gff__
0000000000000200050000000000000000000000000000000000000000000000000000000000000000000000009400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0202040404040404040404040404040202020202020202020303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202040308080808030303030303040404020202020202020303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202040308060608040404020303030303040402020202020303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202040308080608040604040304040403030402020204020303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202040603030808040404030304040404030404020202020303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020204030404040404030404040404030404020202020304030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020203030404040406030404040404030402020204020303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020303020603040404040303030303030402020202020202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202030304030304030303030304030303030402020202020202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202030202020204040404040303030303030402020202020202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202030303030303030403030304030404040402020202020202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030403030303020202020202020202020204020202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030304030303020202020202020202020202020202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030304030403040303020202000000020202020202030303020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303030303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303040303030303030403030303030403030303040303030304030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303030303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0005000000000000000000000000000000007000060000601127016250262102e230322500000000000000000000000000243501b3502e3500000025550375503f55000000085500000000000000000000000000
000b000017650006502c6500065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 01024344

